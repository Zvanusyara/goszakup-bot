"""
–ü–∞—Ä—Å–µ—Ä –¥–ª—è API –ø–æ—Ä—Ç–∞–ª–∞ goszakup.gov.kz
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç GraphQL API –¥–ª—è –ø–æ–∏—Å–∫–∞ –ª–æ—Ç–æ–≤ –∏ –æ–±—ä—è–≤–ª–µ–Ω–∏–π
"""
import requests
import json
from typing import List, Dict, Optional
from datetime import datetime, timedelta
import time
import sys
import os

sys.path.append(os.path.dirname(os.path.dirname(os.path.abspath(__file__))))

from config import GOSZAKUP_API_URL, GOSZAKUP_API_TOKEN, ALL_KEYWORDS, RESULTS_PER_PAGE


class GoszakupParser:
    """–ü–∞—Ä—Å–µ—Ä –¥–ª—è –ø–æ—Ä—Ç–∞–ª–∞ –≥–æ—Å–∑–∞–∫—É–ø–æ–∫ –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–∞"""

    # –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –º–µ—Ç–æ–¥–æ–≤ —Ç–æ—Ä–≥–æ–≤–ª–∏ (—Å–ø–æ—Å–æ–±—ã –∑–∞–∫—É–ø–∫–∏)
    TRADE_METHODS = {
        202: '–¢–µ–Ω–¥–µ—Ä –ø–æ —Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤—É ¬´–ø–æ–¥ –∫–ª—é—á¬ª',
        201: '–ö–æ–Ω–∫—É—Ä—Å –ø–æ —Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤—É ¬´–ø–æ–¥ –∫–ª—é—á¬ª',
        200: '–¢–µ–Ω–¥–µ—Ä —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ä–µ–π—Ç–∏–Ω–≥–æ–≤–æ-–±–∞–ª–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã',
        190: '–¢–µ–Ω–¥–µ—Ä —Å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º –æ—Å–æ–±–æ–≥–æ –ø–æ—Ä—è–¥–∫–∞',
        188: '–ö–æ–Ω–∫—É—Ä—Å —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ä–µ–π—Ç–∏–Ω–≥–æ–≤–æ-–±–∞–ª–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã',
        177: '–ê—É–∫—Ü–∏–æ–Ω (–Ω–µ –ì–ó) —Å 2022 –≥',
        160: '–≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã–π –º–∞–≥–∞–∑–∏–Ω (–Ω–µ –ì–ó)',
        133: '–í—Ç–æ—Ä–æ–π —ç—Ç–∞–ø –∫–æ–Ω–∫—É—Ä—Å–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ä–∞–º–æ—á–Ω–æ–≥–æ —Å–æ–≥–ª–∞—à–µ–Ω–∏—è',
        132: '–ü–µ—Ä–≤—ã–π —ç—Ç–∞–ø –∫–æ–Ω–∫—É—Ä—Å–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ä–∞–º–æ—á–Ω–æ–≥–æ —Å–æ–≥–ª–∞—à–µ–Ω–∏—è',
        131: '–ò–∑ –æ–¥–Ω–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –ø—É—Ç–µ–º –ø—Ä—è–º–æ–≥–æ –∑–∞–∫–ª—é—á–µ–Ω–∏—è –¥–æ–≥–æ–≤–æ—Ä–∞ –ø–æ –ø–∏—Ç–∞–Ω–∏—é –æ–±—É—á–∞—é—â–∏—Ö—Å—è',
        130: '–ì–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–∞–∫—É–ø–∫–∏ —Å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º –æ—Å–æ–±–æ–≥–æ –ø–æ—Ä—è–¥–∫–∞',
        128: '–ö–æ–Ω–∫—É—Ä—Å —Å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–≥–æ –ø–æ—Ä—è–¥–∫–∞',
        126: '–ó–∞–ø—Ä–æ—Å —Ü–µ–Ω–æ–≤—ã—Ö –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π (–Ω–µ –ì–ó new)',
        125: '–ò–∑ –æ–¥–Ω–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –ø–æ –Ω–µ—Å–æ—Å—Ç–æ—è–≤—à–∏–º—Å—è –∑–∞–∫—É–ø–∫–∞–º –Ω–µ –ì–ó',
        124: '–¢–µ–Ω–¥–µ—Ä',
        123: '–ò–∑ –æ–¥–Ω–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –ø—É—Ç–µ–º –ø—Ä—è–º–æ–≥–æ –∑–∞–∫–ª—é—á–µ–Ω–∏—è –¥–æ–≥–æ–≤–æ—Ä–∞ (–Ω–µ –ì–ó)',
        122: '–î–æ–≥–æ–≤–æ—Ä –Ω–∞ —É—Å–ª—É–≥–∏ –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–æ–≥–æ –∑–∞–∫–∞–∑–∞',
        121: '–ö–æ–Ω–∫—É—Ä—Å –ø–æ –ø—Ä–∏–æ–±—Ä–µ—Ç–µ–Ω–∏—é —Ç–æ–≤–∞—Ä–æ–≤, —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ–º –ø–∏—Ç–∞–Ω–∏—è –≤–æ—Å–ø–∏—Ç–∞–Ω–Ω–∏–∫–æ–≤ –∏ –æ–±—É—á–∞—é—â–∏—Ö—Å—è',
        120: '–ö–æ–Ω–∫—É—Ä—Å –ø–æ –ø—Ä–∏–æ–±—Ä–µ—Ç–µ–Ω–∏—é —É—Å–ª—É–≥ –ø–æ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –ø–∏—Ç–∞–Ω–∏—è –≤–æ—Å–ø–∏—Ç–∞–Ω–Ω–∏–∫–æ–≤ –∏ –æ–±—É—á–∞—é—â–∏—Ö—Å—è',
        105: '–ò–∑ –æ–¥–Ω–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ (–Ω–µ –ì–ó)',
        78: '–ê—É–∫—Ü–∏–æ–Ω',
        77: '–ê—É–∫—Ü–∏–æ–Ω (—Å 2022)',
        60: '–≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã–π –º–∞–≥–∞–∑–∏–Ω',
        52: '–ó–∞–∫—É–ø–∫–∞ –ø–æ –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω–æ–º—É —Å–æ—Ü–∏–∞–ª—å–Ω–æ–º—É –∑–∞–∫–∞–∑—É',
        50: '–ó–∞–∫—É–ø–∫–∞ –∂–∏–ª–∏—â–∞',
        32: '–ö–æ–Ω–∫—É—Ä—Å —Å –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–º –∫–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏–æ–Ω–Ω—ã–º –æ—Ç–±–æ—Ä–æ–º',
        23: '–ò–∑ –æ–¥–Ω–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –ø—É—Ç–µ–º –ø—Ä—è–º–æ–≥–æ –∑–∞–∫–ª—é—á–µ–Ω–∏—è –¥–æ–≥–æ–≤–æ—Ä–∞',
        22: '–ö–æ–Ω–∫—É—Ä—Å —Å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º –¥–≤—É—Ö—ç—Ç–∞–ø–Ω—ã—Ö –ø—Ä–æ—Ü–µ–¥—É—Ä',
        8: '–ß–µ—Ä–µ–∑ —Ç–æ–≤–∞—Ä–Ω—ã–µ –±–∏—Ä–∂–∏',
        7: '–ê—É–∫—Ü–∏–æ–Ω (–¥–æ 2022)',
        6: '–ò–∑ –æ–¥–Ω–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –ø–æ –Ω–µ—Å–æ—Å—Ç–æ—è–≤—à–∏–º—Å—è –∑–∞–∫—É–ø–∫–∞–º',
        3: '–ó–∞–ø—Ä–æ—Å —Ü–µ–Ω–æ–≤—ã—Ö –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π',
        2: '–û—Ç–∫—Ä—ã—Ç—ã–π –∫–æ–Ω–∫—É—Ä—Å'
    }

    def __init__(self):
        self.graphql_url = GOSZAKUP_API_URL
        self.rest_api_base = "https://ows.goszakup.gov.kz/v3"
        self.session = requests.Session()

        # –ë–∞–∑–æ–≤—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏
        headers = {
            'Content-Type': 'application/json',
            'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36'
        }

        # –î–æ–±–∞–≤–ª—è–µ–º —Ç–æ–∫–µ–Ω –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏, –µ—Å–ª–∏ –æ–Ω –µ—Å—Ç—å
        if GOSZAKUP_API_TOKEN:
            headers['Authorization'] = f'Bearer {GOSZAKUP_API_TOKEN}'

        self.session.headers.update(headers)

    def search_lots(self, keywords: List[str], days_back: int = 7) -> List[Dict]:
        """
        –ü–æ–∏—Å–∫ –ª–æ—Ç–æ–≤ –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ N –¥–Ω–µ–π

        Args:
            keywords: –°–ø–∏—Å–æ–∫ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤ –¥–ª—è –ø–æ–∏—Å–∫–∞
            days_back: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–Ω–µ–π –Ω–∞–∑–∞–¥ –¥–ª—è –ø–æ–∏—Å–∫–∞

        Returns:
            –°–ø–∏—Å–æ–∫ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –æ–±—ä—è–≤–ª–µ–Ω–∏–π —Å –º–∞—Å—Å–∏–≤–∞–º–∏ –ª–æ—Ç–æ–≤
        """
        print(f"üîç –ü–æ–∏—Å–∫ –ª–æ—Ç–æ–≤ –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º: {', '.join(keywords)}")

        start_date = (datetime.now() - timedelta(days=days_back)).strftime('%Y-%m-%d')
        found_lots = []

        # –ò—Å–ø–æ–ª—å–∑—É–µ–º REST API v3 –¥–ª—è –ø–æ–∏—Å–∫–∞ –ª–æ—Ç–æ–≤
        # Endpoint: /lots
        lots_url = f"{self.rest_api_base}/lots"

        params = {
            'limit': RESULTS_PER_PAGE,
            'offset': 0,
            'start_date': start_date  # –î–æ–±–∞–≤–ª—è–µ–º –¥–∞—Ç—É –Ω–∞—á–∞–ª–∞
        }

        try:
            response = self.session.get(lots_url, params=params, timeout=30)
            response.raise_for_status()
            data = response.json()

            if 'items' in data:
                for lot in data['items']:
                    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤ –≤ –Ω–∞–∑–≤–∞–Ω–∏–∏ –ª–æ—Ç–∞
                    lot_name = lot.get('name_ru', '').lower()
                    lot_desc = lot.get('description_ru', '').lower()

                    matched_keyword = None
                    for keyword in keywords:
                        if keyword.lower() in lot_name or keyword.lower() in lot_desc:
                            matched_keyword = keyword
                            break

                    if matched_keyword:
                        # –ò–∑–≤–ª–µ–∫–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ª–æ—Ç–∞
                        lot_data = self._extract_lot_data(lot, matched_keyword)
                        if lot_data:
                            found_lots.append(lot_data)
                            print(f"‚úÖ –ù–∞–π–¥–µ–Ω –ª–æ—Ç: {lot_data['lot_name'][:50]}...")

            print(f"üìä –í—Å–µ–≥–æ –Ω–∞–π–¥–µ–Ω–æ –ª–æ—Ç–æ–≤: {len(found_lots)}")

            # –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –ª–æ—Ç—ã –ø–æ announcement_number
            announcements = self._group_lots_by_announcement(found_lots)
            print(f"üì¶ –°–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω–æ –≤ –æ–±—ä—è–≤–ª–µ–Ω–∏–π: {len(announcements)}")

            return announcements

        except requests.RequestException as e:
            print(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–∏—Å–∫–µ –ª–æ—Ç–æ–≤: {e}")
            return []

    def _group_lots_by_announcement(self, lots: List[Dict]) -> List[Dict]:
        """
        –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –ª–æ—Ç—ã –ø–æ –Ω–æ–º–µ—Ä—É –æ–±—ä—è–≤–ª–µ–Ω–∏—è

        Args:
            lots: –°–ø–∏—Å–æ–∫ –ª–æ—Ç–æ–≤

        Returns:
            –°–ø–∏—Å–æ–∫ –æ–±—ä—è–≤–ª–µ–Ω–∏–π —Å –º–∞—Å—Å–∏–≤–∞–º–∏ –ª–æ—Ç–æ–≤
        """
        from collections import defaultdict

        # –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –ø–æ announcement_number
        announcements_dict = defaultdict(list)

        for lot_data in lots:
            announcement_number = lot_data['announcement_number']
            announcements_dict[announcement_number].append(lot_data)

        # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤ —Å–ø–∏—Å–æ–∫ –æ–±—ä—è–≤–ª–µ–Ω–∏–π
        announcements = []
        for announcement_number, lot_list in announcements_dict.items():
            # –ë–µ—Ä–µ–º –ø–µ—Ä–≤—ã–π –ª–æ—Ç –∫–∞–∫ –±–∞–∑—É –¥–ª—è –¥–∞–Ω–Ω—ã—Ö –æ–±—ä—è–≤–ª–µ–Ω–∏—è
            first_lot = lot_list[0]

            # –§–æ—Ä–º–∏—Ä—É–µ–º –º–∞—Å—Å–∏–≤ –ª–æ—Ç–æ–≤ –¥–ª—è JSON
            lots_array = [
                {
                    'number': lot.get('lot_number'),  # –†–µ–∞–ª—å–Ω—ã–π –Ω–æ–º–µ—Ä –ª–æ—Ç–∞
                    'name': lot['lot_name'],
                    'description': lot['lot_description'],
                    'keyword': lot['keyword_matched']
                }
                for lot in lot_list
            ]

            # –°–æ–±–∏—Ä–∞–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞
            all_keywords = list(set(lot['keyword_matched'] for lot in lot_list))

            announcement = {
                'announcement_number': announcement_number,
                'announcement_url': first_lot['announcement_url'],
                'organization_name': first_lot['organization_name'],
                'organization_bin': first_lot['organization_bin'],
                'legal_address': first_lot['legal_address'],
                'region': first_lot['region'],
                'application_deadline': first_lot['application_deadline'],
                'procurement_method': first_lot['procurement_method'],
                'lots': lots_array,  # –ú–∞—Å—Å–∏–≤ –ª–æ—Ç–æ–≤
                'keyword_matched': ', '.join(all_keywords)  # –í—Å–µ –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é
            }

            announcements.append(announcement)
            print(f"üìã –û–±—ä—è–≤–ª–µ–Ω–∏–µ {announcement_number}: {len(lot_list)} –ª–æ—Ç(–æ–≤)")

        return announcements

    def _extract_lot_data(self, lot: Dict, keyword: str) -> Optional[Dict]:
        """–ò–∑–≤–ª–µ—á—å –¥–∞–Ω–Ω—ã–µ –∏–∑ –ª–æ—Ç–∞"""
        try:
            # –ü–æ–ª—É—á–∞–µ–º –Ω–æ–º–µ—Ä –æ–±—ä—è–≤–ª–µ–Ω–∏—è
            trd_buy_id = lot.get('trd_buy_id')
            if not trd_buy_id:
                print(f"‚ö†Ô∏è –£ –ª–æ—Ç–∞ –Ω–µ—Ç trd_buy_id")
                return None

            print(f"üîç –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–µ—Ç–∞–ª–µ–π –æ–±—ä—è–≤–ª–µ–Ω–∏—è {trd_buy_id}...")

            # –ü–æ–ª—É—á–∞–µ–º –¥–µ—Ç–∞–ª–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏—è
            announcement_data = self.get_announcement_details(trd_buy_id)
            if not announcement_data:
                print(f"‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –¥–µ—Ç–∞–ª–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏—è {trd_buy_id}")
                return None

            kato_code = announcement_data.get('kato_code', '')
            customer_name = announcement_data.get('customer_name', 'N/A')
            customer_bin = announcement_data.get('customer_bin', 'N/A')

            # –ü–æ–ª—É—á–∞–µ–º —Ä–µ–∞–ª—å–Ω—ã–π –∞–¥—Ä–µ—Å –ø–æ –ë–ò–ù
            print(f"üè¢ –ó–∞–ø—Ä–æ—Å –∞–¥—Ä–µ—Å–∞ –¥–ª—è –ë–ò–ù: {customer_bin}")
            legal_address = self.get_customer_address(customer_bin)
            print(f"üìç –ü–æ–ª—É—á–µ–Ω–Ω—ã–π –∞–¥—Ä–µ—Å: {legal_address}")

            # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ä–µ–≥–∏–æ–Ω –∏–∑ —é—Ä–∏–¥–∏—á–µ—Å–∫–æ–≥–æ –∞–¥—Ä–µ—Å–∞ (–¢–û–õ–¨–ö–û –∏–∑ –∞–¥—Ä–µ—Å–∞, –±–µ–∑ KATO)
            print(f"üîç –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ–≥–∏–æ–Ω–∞ –∏–∑ –∞–¥—Ä–µ—Å–∞: '{legal_address}'")
            region = self._extract_region(legal_address)
            print(f"   –†–µ–∑—É–ª—å—Ç–∞—Ç: '{region}'")

            # –§–æ—Ä–º–∏—Ä—É–µ–º –ø–æ–ª–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
            return {
                'announcement_number': announcement_data.get('number_anno', 'N/A'),
                'announcement_url': f"https://goszakup.gov.kz/ru/announce/index/{trd_buy_id}",
                'organization_name': customer_name,
                'organization_bin': customer_bin,
                'legal_address': legal_address,
                'region': region,
                'lot_number': lot.get('id') or lot.get('number') or lot.get('lot_number'),  # –†–µ–∞–ª—å–Ω—ã–π –Ω–æ–º–µ—Ä –ª–æ—Ç–∞
                'lot_name': lot.get('name_ru', 'N/A'),
                'lot_description': lot.get('description_ru', ''),
                'keyword_matched': keyword,
                'application_deadline': announcement_data.get('application_deadline'),
                'procurement_method': announcement_data.get('procurement_method')
            }

        except Exception as e:
            print(f"‚ö†Ô∏è –û—à–∏–±–∫–∞ –ø—Ä–∏ –∏–∑–≤–ª–µ—á–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö –ª–æ—Ç–∞: {e}")
            return None

    def get_customer_address(self, customer_bin: str) -> str:
        """
        –ü–æ–ª—É—á–∏—Ç—å —é—Ä–∏–¥–∏—á–µ—Å–∫–∏–π –∞–¥—Ä–µ—Å –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –ø–æ –ë–ò–ù

        Args:
            customer_bin: –ë–ò–ù –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏

        Returns:
            –Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–π –∞–¥—Ä–µ—Å
        """
        if not customer_bin or customer_bin == 'N/A':
            return '–ù–µ —É–∫–∞–∑–∞–Ω'

        url = f"{self.rest_api_base}/subject/biin/{customer_bin}/address"

        try:
            response = self.session.get(url, timeout=10)
            response.raise_for_status()
            data = response.json()

            if 'items' in data and len(data['items']) > 0:
                # –ë–µ—Ä–µ–º –ø–µ—Ä–≤—ã–π –∞–¥—Ä–µ—Å (–æ–±—ã—á–Ω–æ —ç—Ç–æ —é—Ä–∏–¥–∏—á–µ—Å–∫–∏–π –∞–¥—Ä–µ—Å)
                address = data['items'][0].get('address', '–ù–µ —É–∫–∞–∑–∞–Ω')
                print(f"   ‚úì –ü–æ–ª—É—á–µ–Ω –∞–¥—Ä–µ—Å –ø–æ –ë–ò–ù {customer_bin}: {address}")
                return address
            else:
                print(f"   ‚ö†Ô∏è –ê–¥—Ä–µ—Å –Ω–µ –Ω–∞–π–¥–µ–Ω –¥–ª—è –ë–ò–ù {customer_bin}")
                return '–ù–µ —É–∫–∞–∑–∞–Ω'

        except Exception as e:
            print(f"   ‚ö†Ô∏è –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –∞–¥—Ä–µ—Å–∞ –¥–ª—è –ë–ò–ù {customer_bin}: {e}")
            return '–ù–µ —É–∫–∞–∑–∞–Ω'

    def get_announcement_details(self, trd_buy_id: int) -> Optional[Dict]:
        """
        –ü–æ–ª—É—á–∏—Ç—å –¥–µ—Ç–∞–ª–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏—è –ø–æ ID

        Args:
            trd_buy_id: ID –æ–±—ä—è–≤–ª–µ–Ω–∏—è

        Returns:
            –°–ª–æ–≤–∞—Ä—å —Å –¥–∞–Ω–Ω—ã–º–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏—è
        """
        url = f"{self.rest_api_base}/trd-buy/{trd_buy_id}"

        try:
            response = self.session.get(url, timeout=30)
            response.raise_for_status()
            data = response.json()

            # –ò—Å–ø–æ–ª—å–∑—É–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ –æ—Ç–≤–µ—Ç–∞
            kato_raw = data.get('kato', '')
            # KATO –º–æ–∂–µ—Ç –±—ã—Ç—å –º–∞—Å—Å–∏–≤–æ–º, –±–µ—Ä–µ–º –ø–µ—Ä–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç
            if isinstance(kato_raw, list) and kato_raw:
                kato_code = str(kato_raw[0])
            else:
                kato_code = str(kato_raw) if kato_raw else ''

            customer_name = data.get('customer_name_ru') or data.get('org_name_ru', 'N/A')
            customer_bin = data.get('customer_bin') or data.get('org_bin', None)

            # –ü–æ–ª—É—á–∞–µ–º —Å—Ä–æ–∫ –æ–∫–æ–Ω—á–∞–Ω–∏—è –ø—Ä–∏–µ–º–∞ –∑–∞—è–≤–æ–∫
            end_date_str = data.get('end_date') or data.get('application_end_date')
            application_deadline = None
            if end_date_str:
                try:
                    # –ü–∞—Ä—Å–∏–º –¥–∞—Ç—É –∏–∑ —Å—Ç—Ä–æ–∫–∏ (–æ–±—ã—á–Ω–æ —Ñ–æ—Ä–º–∞—Ç ISO 8601)
                    from dateutil import parser as date_parser
                    application_deadline = date_parser.parse(end_date_str)
                except Exception as e:
                    print(f"   ‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç—å –¥–∞—Ç—É –æ–∫–æ–Ω—á–∞–Ω–∏—è –ø—Ä–∏–µ–º–∞ –∑–∞—è–≤–æ–∫: {end_date_str}, –æ—à–∏–±–∫–∞: {e}")

            # –ü–æ–ª—É—á–∞–µ–º —Å–ø–æ—Å–æ–± –∑–∞–∫—É–ø–∫–∏ –ø–æ ID –∏–∑ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞
            trade_method_id = data.get('ref_trade_methods_id')
            procurement_method = None

            if trade_method_id:
                procurement_method = self.TRADE_METHODS.get(trade_method_id)
                if not procurement_method:
                    print(f"   ‚ö†Ô∏è –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –º–µ—Ç–æ–¥ —Ç–æ—Ä–≥–æ–≤–ª–∏ ID: {trade_method_id}")
                    procurement_method = f"ID: {trade_method_id}"

            print(f"üìã –î–∞–Ω–Ω—ã–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è {trd_buy_id}:")
            print(f"   - KATO (—Å—ã—Ä–æ–π): {kato_raw}")
            print(f"   - KATO (–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π): {kato_code}")
            print(f"   - –ë–ò–ù: {customer_bin}")
            print(f"   - –ó–∞–∫–∞–∑—á–∏–∫: {customer_name}")
            print(f"   - –°—Ä–æ–∫ –æ–∫–æ–Ω—á–∞–Ω–∏—è –ø—Ä–∏–µ–º–∞ –∑–∞—è–≤–æ–∫: {application_deadline}")
            print(f"   - –°–ø–æ—Å–æ–± –∑–∞–∫—É–ø–∫–∏: {procurement_method}")

            return {
                'number_anno': data.get('number_anno', 'N/A'),
                'customer_name': customer_name,
                'customer_bin': customer_bin,
                'kato_code': kato_code,
                'customer_region': 'N/A',  # –ë—É–¥–µ–º –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å –ø–æ KATO
                'application_deadline': application_deadline,
                'procurement_method': procurement_method
            }

        except requests.RequestException as e:
            print(f"‚ö†Ô∏è –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –¥–µ—Ç–∞–ª–µ–π –æ–±—ä—è–≤–ª–µ–Ω–∏—è {trd_buy_id}: {e}")
            # –ü—Ä–æ–±—É–µ–º –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Å–æ–± —á–µ—Ä–µ–∑ GraphQL
            return self._get_announcement_graphql(trd_buy_id)

    def _get_announcement_graphql(self, trd_buy_id: int) -> Optional[Dict]:
        """–ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ GraphQL"""
        query = """
        query($id: Int!) {
            trd_buy(id: $id) {
                id
                number_anno
                name_ru
                customer {
                    bin
                    name_ru
                    legal_address
                    region {
                        name_ru
                    }
                }
            }
        }
        """

        variables = {"id": trd_buy_id}

        try:
            response = self.session.post(
                self.graphql_url,
                json={'query': query, 'variables': variables},
                timeout=30
            )
            response.raise_for_status()
            data = response.json()

            if 'data' in data and data['data'].get('trd_buy'):
                buy_data = data['data']['trd_buy']
                customer = buy_data.get('customer', {})

                # –õ–æ–≥–∏—Ä—É–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–Ω—ã—Ö GraphQL
                print(f"üìã –î–∞–Ω–Ω—ã–µ GraphQL:")
                print(f"   - customer: {customer}")
                print(f"   - legal_address: {customer.get('legal_address', '–ù–ï–¢')}")
                print(f"   - region: {customer.get('region', '–ù–ï–¢')}")

                return {
                    'number_anno': buy_data.get('number_anno', 'N/A'),
                    'customer_name': customer.get('name_ru', 'N/A'),
                    'customer_bin': customer.get('bin', 'N/A'),
                    'customer_address': customer.get('legal_address', 'N/A'),
                    'customer_region': customer.get('region', {}).get('name_ru', 'N/A')
                }

        except Exception as e:
            print(f"‚ö†Ô∏è –û—à–∏–±–∫–∞ GraphQL –∑–∞–ø—Ä–æ—Å–∞: {e}")
            return None

    def _extract_region_from_kato(self, kato_code: str) -> str:
        """
        –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ä–µ–≥–∏–æ–Ω –ø–æ –∫–æ–¥—É KATO

        Args:
            kato_code: –ö–æ–¥ –ö–ê–¢–û (–ø–µ—Ä–≤—ã–µ 2 —Ü–∏—Ñ—Ä—ã –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç —Ä–µ–≥–∏–æ–Ω)

        Returns:
            –ù–∞–∑–≤–∞–Ω–∏–µ —Ä–µ–≥–∏–æ–Ω–∞
        """
        if not kato_code or len(kato_code) < 2:
            return "–ù–µ —É–∫–∞–∑–∞–Ω"

        # –ü–µ—Ä–≤—ã–µ 2 —Ü–∏—Ñ—Ä—ã KATO - –∫–æ–¥ —Ä–µ–≥–∏–æ–Ω–∞
        region_code = kato_code[:2]

        print(f"üîç –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ–≥–∏–æ–Ω–∞ –ø–æ KATO: {kato_code} (–∫–æ–¥ —Ä–µ–≥–∏–æ–Ω–∞: {region_code})")

        # –ú–∞–ø–ø–∏–Ω–≥ –∫–æ–¥–æ–≤ KATO –Ω–∞ —Ä–µ–≥–∏–æ–Ω—ã –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–∞
        # –í–∫–ª—é—á–∞—è –æ—Å–Ω–æ–≤–Ω—ã–µ –∏ —Ä–∞–π–æ–Ω–Ω—ã–µ –∫–æ–¥—ã
        kato_regions = {
            '01': '–ê–∫–º–æ–ª–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '02': '–ê–∫—Ç—é–±–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '03': '–ê–ª–º–∞—Ç–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '04': '–ê—Ç—ã—Ä–∞—É—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '05': '–í–æ—Å—Ç–æ—á–Ω–æ-–ö–∞–∑–∞—Ö—Å—Ç–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '06': '–ñ–∞–º–±—ã–ª—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '07': '–ó–∞–ø–∞–¥–Ω–æ-–ö–∞–∑–∞—Ö—Å—Ç–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '08': '–ö–∞—Ä–∞–≥–∞–Ω–¥–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '09': '–ö–æ—Å—Ç–∞–Ω–∞–π—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '10': '–ö—ã–∑—ã–ª–æ—Ä–¥–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '11': '–ú–∞–Ω–≥–∏—Å—Ç–∞—É—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '15': '–ü–∞–≤–ª–æ–¥–∞—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '16': '–°–µ–≤–µ—Ä–æ-–ö–∞–∑–∞—Ö—Å—Ç–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '17': '–¢—É—Ä–∫–µ—Å—Ç–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '19': '–ê–±–∞–π—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '20': '–ñ–µ—Ç—ñ—Å—É—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '21': '–£–ª—ã—Ç–∞—É—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '71': '–≥. –ê—Å—Ç–∞–Ω–∞',
            '75': '–≥. –ê–ª–º–∞—Ç—ã',
            '79': '–≥. –®—ã–º–∫–µ–Ω—Ç',

            # –†–∞–π–æ–Ω–Ω—ã–µ –∫–æ–¥—ã (–Ω–∞—á–∏–Ω–∞—é—â–∏–µ—Å—è —Å –¥—Ä—É–≥–∏—Ö —Ü–∏—Ñ—Ä)
            '43': '–ê—Ç—ã—Ä–∞—É—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',    # –†–∞–π–æ–Ω—ã –ê—Ç—ã—Ä–∞—É—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏
            '44': '–ê—Ç—ã—Ä–∞—É—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '45': '–ê—Ç—ã—Ä–∞—É—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '55': '–ü–∞–≤–ª–æ–¥–∞—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',  # –†–∞–π–æ–Ω—ã –ü–∞–≤–ª–æ–¥–∞—Ä—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏
            '56': '–ü–∞–≤–ª–æ–¥–∞—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '61': '–¢—É—Ä–∫–µ—Å—Ç–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',  # –Æ–∂–Ω—ã–µ —Ä–µ–≥–∏–æ–Ω—ã
            '62': '–¢—É—Ä–∫–µ—Å—Ç–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '63': '–í–æ—Å—Ç–æ—á–Ω–æ-–ö–∞–∑–∞—Ö—Å—Ç–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å'  # –í–æ—Å—Ç–æ—á–Ω—ã–µ —Ä–µ–≥–∏–æ–Ω—ã
        }

        region = kato_regions.get(region_code, '–î—Ä—É–≥–æ–π —Ä–µ–≥–∏–æ–Ω')
        print(f"‚úÖ –†–µ–≥–∏–æ–Ω –æ–ø—Ä–µ–¥–µ–ª–µ–Ω –ø–æ KATO: {region}")
        return region

    def _extract_region(self, address: str) -> str:
        """
        –ò–∑–≤–ª–µ—á—å —Ä–µ–≥–∏–æ–Ω –∏–∑ —é—Ä–∏–¥–∏—á–µ—Å–∫–æ–≥–æ –∞–¥—Ä–µ—Å–∞

        Args:
            address: –Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–π –∞–¥—Ä–µ—Å

        Returns:
            –ù–∞–∑–≤–∞–Ω–∏–µ —Ä–µ–≥–∏–æ–Ω–∞
        """
        if not address:
            return "–ù–µ —É–∫–∞–∑–∞–Ω"

        address_lower = address.lower()

        # –°–ø–∏—Å–æ–∫ –æ–±–ª–∞—Å—Ç–µ–π –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–∞ —Å –≤–∞—Ä–∏–∞–Ω—Ç–∞–º–∏ –Ω–∞–ø–∏—Å–∞–Ω–∏—è
        # –ü–æ—Ä—è–¥–æ–∫ –≤–∞–∂–µ–Ω: —Å–Ω–∞—á–∞–ª–∞ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã, –ø–æ—Ç–æ–º –æ–±—â–∏–µ
        regions_map = {
            # –ê–ª–º–∞—Ç–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å (–¥–æ –ê–ª–º–∞—Ç—ã, —á—Ç–æ–±—ã –Ω–µ –ø–µ—Ä–µ–ø—É—Ç–∞—Ç—å)
            '–∞–ª–º–∞—Ç–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å': '–ê–ª–º–∞—Ç–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–∞–ª–º–∞—Ç–∏–Ω—Å–∫–∞—è –æ–±–ª': '–ê–ª–º–∞—Ç–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–∞–ª–º–∞—Ç. –æ–±–ª': '–ê–ª–º–∞—Ç–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–∞–ª–º–∞—Ç–∏–Ω—Å–∫–∞—è': '–ê–ª–º–∞—Ç–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',

            # –ê–ª–º–∞—Ç—ã (–≥–æ—Ä–æ–¥)
            '–≥. –∞–ª–º–∞—Ç—ã': '–≥. –ê–ª–º–∞—Ç—ã',
            '–≥.–∞–ª–º–∞—Ç—ã': '–≥. –ê–ª–º–∞—Ç—ã',
            '–≥–æ—Ä–æ–¥ –∞–ª–º–∞—Ç—ã': '–≥. –ê–ª–º–∞—Ç—ã',
            'qala almaty': '–≥. –ê–ª–º–∞—Ç—ã',
            'almaty qalasy': '–≥. –ê–ª–º–∞—Ç—ã',
            ' –∞–ª–º–∞—Ç—ã': '–≥. –ê–ª–º–∞—Ç—ã',  # —Å –ø—Ä–æ–±–µ–ª–æ–º —Å–ø–µ—Ä–µ–¥–∏ –¥–ª—è —Ç–æ—á–Ω–æ—Å—Ç–∏
            '–∞–ª–º–∞—Ç—ã,': '–≥. –ê–ª–º–∞—Ç—ã',
            '–∞–ª–º–∞—Ç—ã ': '–≥. –ê–ª–º–∞—Ç—ã',

            # –ê—Å—Ç–∞–Ω–∞ (–≥–æ—Ä–æ–¥)
            '–≥. –∞—Å—Ç–∞–Ω–∞': '–≥. –ê—Å—Ç–∞–Ω–∞',
            '–≥.–∞—Å—Ç–∞–Ω–∞': '–≥. –ê—Å—Ç–∞–Ω–∞',
            '–≥–æ—Ä–æ–¥ –∞—Å—Ç–∞–Ω–∞': '–≥. –ê—Å—Ç–∞–Ω–∞',
            '–≥. –Ω—É—Ä-—Å—É–ª—Ç–∞–Ω': '–≥. –ê—Å—Ç–∞–Ω–∞',
            '–≥.–Ω—É—Ä-—Å—É–ª—Ç–∞–Ω': '–≥. –ê—Å—Ç–∞–Ω–∞',
            '–Ω—É—Ä-—Å—É–ª—Ç–∞–Ω': '–≥. –ê—Å—Ç–∞–Ω–∞',
            ' –∞—Å—Ç–∞–Ω–∞': '–≥. –ê—Å—Ç–∞–Ω–∞',
            '–∞—Å—Ç–∞–Ω–∞,': '–≥. –ê—Å—Ç–∞–Ω–∞',
            '–∞—Å—Ç–∞–Ω–∞ ': '–≥. –ê—Å—Ç–∞–Ω–∞',
            'astana': '–≥. –ê—Å—Ç–∞–Ω–∞',

            # –ê–∫–º–æ–ª–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å
            '–∞–∫–º–æ–ª–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å': '–ê–∫–º–æ–ª–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–∞–∫–º–æ–ª–∏–Ω—Å–∫–∞—è –æ–±–ª': '–ê–∫–º–æ–ª–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–∞–∫–º–æ–ª. –æ–±–ª': '–ê–∫–º–æ–ª–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–∞–∫–º–æ–ª–∏–Ω—Å–∫–∞—è': '–ê–∫–º–æ–ª–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–≥. –∫–æ–∫—à–µ—Ç–∞—É': '–ê–∫–º–æ–ª–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–≥.–∫–æ–∫—à–µ—Ç–∞—É': '–ê–∫–º–æ–ª–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–∫–æ–∫—à–µ—Ç–∞—É': '–ê–∫–º–æ–ª–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',

            # –¢—É—Ä–∫–µ—Å—Ç–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å
            '—Ç—É—Ä–∫–µ—Å—Ç–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å': '–¢—É—Ä–∫–µ—Å—Ç–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '—Ç—É—Ä–∫–µ—Å—Ç–∞–Ω—Å–∫–∞—è –æ–±–ª': '–¢—É—Ä–∫–µ—Å—Ç–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '—Ç—É—Ä–∫–µ—Å—Ç. –æ–±–ª': '–¢—É—Ä–∫–µ—Å—Ç–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '—Ç—É—Ä–∫–µ—Å—Ç–∞–Ω—Å–∫–∞—è': '–¢—É—Ä–∫–µ—Å—Ç–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–≥. —Ç—É—Ä–∫–µ—Å—Ç–∞–Ω': '–¢—É—Ä–∫–µ—Å—Ç–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–≥.—Ç—É—Ä–∫–µ—Å—Ç–∞–Ω': '–¢—É—Ä–∫–µ—Å—Ç–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '—Ç—É—Ä–∫–µ—Å—Ç–∞–Ω': '–¢—É—Ä–∫–µ—Å—Ç–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',

            # –®—ã–º–∫–µ–Ω—Ç (–≥–æ—Ä–æ–¥)
            '–≥. —à—ã–º–∫–µ–Ω—Ç': '–≥. –®—ã–º–∫–µ–Ω—Ç',
            '–≥.—à—ã–º–∫–µ–Ω—Ç': '–≥. –®—ã–º–∫–µ–Ω—Ç',
            '–≥–æ—Ä–æ–¥ —à—ã–º–∫–µ–Ω—Ç': '–≥. –®—ã–º–∫–µ–Ω—Ç',
            ' —à—ã–º–∫–µ–Ω—Ç': '–≥. –®—ã–º–∫–µ–Ω—Ç',
            '—à—ã–º–∫–µ–Ω—Ç,': '–≥. –®—ã–º–∫–µ–Ω—Ç',
            '—à—ã–º–∫–µ–Ω—Ç ': '–≥. –®—ã–º–∫–µ–Ω—Ç',
            'shymkent': '–≥. –®—ã–º–∫–µ–Ω—Ç',

            # –ê–∫—Ç—é–±–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å
            '–∞–∫—Ç—é–±–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å': '–ê–∫—Ç—é–±–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–∞–∫—Ç—é–±–∏–Ω—Å–∫–∞—è –æ–±–ª': '–ê–∫—Ç—é–±–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–∞–∫—Ç—é–±. –æ–±–ª': '–ê–∫—Ç—é–±–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–∞–∫—Ç—é–±–∏–Ω—Å–∫–∞—è': '–ê–∫—Ç—é–±–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–≥. –∞–∫—Ç–æ–±–µ': '–ê–∫—Ç—é–±–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–≥.–∞–∫—Ç–æ–±–µ': '–ê–∫—Ç—é–±–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–≥. –∞–∫—Ç—é–±–∏–Ω—Å–∫': '–ê–∫—Ç—é–±–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–∞–∫—Ç–æ–±–µ': '–ê–∫—Ç—é–±–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',

            # –ê—Ç—ã—Ä–∞—É—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å
            '–∞—Ç—ã—Ä–∞—É—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å': '–ê—Ç—ã—Ä–∞—É—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–∞—Ç—ã—Ä–∞—É—Å–∫–∞—è –æ–±–ª': '–ê—Ç—ã—Ä–∞—É—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–∞—Ç—ã—Ä–∞—É. –æ–±–ª': '–ê—Ç—ã—Ä–∞—É—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–∞—Ç—ã—Ä–∞—É—Å–∫–∞—è': '–ê—Ç—ã—Ä–∞—É—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–≥. –∞—Ç—ã—Ä–∞—É': '–ê—Ç—ã—Ä–∞—É—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–≥.–∞—Ç—ã—Ä–∞—É': '–ê—Ç—ã—Ä–∞—É—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–∞—Ç—ã—Ä–∞—É': '–ê—Ç—ã—Ä–∞—É—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',

            # –í–æ—Å—Ç–æ—á–Ω–æ-–ö–∞–∑–∞—Ö—Å—Ç–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å
            '–≤–æ—Å—Ç–æ—á–Ω–æ-–∫–∞–∑–∞—Ö—Å—Ç–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å': '–í–æ—Å—Ç–æ—á–Ω–æ-–ö–∞–∑–∞—Ö—Å—Ç–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–≤–æ—Å—Ç–æ—á–Ω–æ-–∫–∞–∑–∞—Ö—Å—Ç–∞–Ω—Å–∫–∞—è –æ–±–ª': '–í–æ—Å—Ç–æ—á–Ω–æ-–ö–∞–∑–∞—Ö—Å—Ç–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–≤–æ—Å—Ç–æ—á–Ω–æ-–∫–∞–∑–∞—Ö—Å—Ç–∞–Ω—Å–∫–∞—è': '–í–æ—Å—Ç–æ—á–Ω–æ-–ö–∞–∑–∞—Ö—Å—Ç–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–≤–æ—Å—Ç.-–∫–∞–∑–∞—Ö—Å—Ç–∞–Ω—Å–∫–∞—è': '–í–æ—Å—Ç–æ—á–Ω–æ-–ö–∞–∑–∞—Ö—Å—Ç–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–≤–∫–æ': '–í–æ—Å—Ç–æ—á–Ω–æ-–ö–∞–∑–∞—Ö—Å—Ç–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–≥. —É—Å—Ç—å-–∫–∞–º–µ–Ω–æ–≥–æ—Ä—Å–∫': '–í–æ—Å—Ç–æ—á–Ω–æ-–ö–∞–∑–∞—Ö—Å—Ç–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–≥.—É—Å—Ç—å-–∫–∞–º–µ–Ω–æ–≥–æ—Ä—Å–∫': '–í–æ—Å—Ç–æ—á–Ω–æ-–ö–∞–∑–∞—Ö—Å—Ç–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '—É—Å—Ç—å-–∫–∞–º–µ–Ω–æ–≥–æ—Ä—Å–∫': '–í–æ—Å—Ç–æ—á–Ω–æ-–ö–∞–∑–∞—Ö—Å—Ç–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '”©—Å–∫–µ–º–µ–Ω': '–í–æ—Å—Ç–æ—á–Ω–æ-–ö–∞–∑–∞—Ö—Å—Ç–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',

            # –ñ–∞–º–±—ã–ª—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å
            '–∂–∞–º–±—ã–ª—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å': '–ñ–∞–º–±—ã–ª—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–∂–∞–º–±—ã–ª—Å–∫–∞—è –æ–±–ª': '–ñ–∞–º–±—ã–ª—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–∂–∞–º–±—ã–ª. –æ–±–ª': '–ñ–∞–º–±—ã–ª—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–∂–∞–º–±—ã–ª—Å–∫–∞—è': '–ñ–∞–º–±—ã–ª—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–≥. —Ç–∞—Ä–∞–∑': '–ñ–∞–º–±—ã–ª—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–≥.—Ç–∞—Ä–∞–∑': '–ñ–∞–º–±—ã–ª—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '—Ç–∞—Ä–∞–∑': '–ñ–∞–º–±—ã–ª—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',

            # –ó–∞–ø–∞–¥–Ω–æ-–ö–∞–∑–∞—Ö—Å—Ç–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å
            '–∑–∞–ø–∞–¥–Ω–æ-–∫–∞–∑–∞—Ö—Å—Ç–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å': '–ó–∞–ø–∞–¥–Ω–æ-–ö–∞–∑–∞—Ö—Å—Ç–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–∑–∞–ø–∞–¥–Ω–æ-–∫–∞–∑–∞—Ö—Å—Ç–∞–Ω—Å–∫–∞—è –æ–±–ª': '–ó–∞–ø–∞–¥–Ω–æ-–ö–∞–∑–∞—Ö—Å—Ç–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–∑–∞–ø–∞–¥–Ω–æ-–∫–∞–∑–∞—Ö—Å—Ç–∞–Ω—Å–∫–∞—è': '–ó–∞–ø–∞–¥–Ω–æ-–ö–∞–∑–∞—Ö—Å—Ç–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–∑–∞–ø.-–∫–∞–∑–∞—Ö—Å—Ç–∞–Ω—Å–∫–∞—è': '–ó–∞–ø–∞–¥–Ω–æ-–ö–∞–∑–∞—Ö—Å—Ç–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–∑–∫–æ': '–ó–∞–ø–∞–¥–Ω–æ-–ö–∞–∑–∞—Ö—Å—Ç–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–≥. —É—Ä–∞–ª—å—Å–∫': '–ó–∞–ø–∞–¥–Ω–æ-–ö–∞–∑–∞—Ö—Å—Ç–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–≥.—É—Ä–∞–ª—å—Å–∫': '–ó–∞–ø–∞–¥–Ω–æ-–ö–∞–∑–∞—Ö—Å—Ç–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '—É—Ä–∞–ª—å—Å–∫': '–ó–∞–ø–∞–¥–Ω–æ-–ö–∞–∑–∞—Ö—Å—Ç–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',

            # –ö–∞—Ä–∞–≥–∞–Ω–¥–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å
            '–∫–∞—Ä–∞–≥–∞–Ω–¥–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å': '–ö–∞—Ä–∞–≥–∞–Ω–¥–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–∫–∞—Ä–∞–≥–∞–Ω–¥–∏–Ω—Å–∫–∞—è –æ–±–ª': '–ö–∞—Ä–∞–≥–∞–Ω–¥–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–∫–∞—Ä–∞–≥–∞–Ω–¥. –æ–±–ª': '–ö–∞—Ä–∞–≥–∞–Ω–¥–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–∫–∞—Ä–∞–≥–∞–Ω–¥–∏–Ω—Å–∫–∞—è': '–ö–∞—Ä–∞–≥–∞–Ω–¥–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–≥. –∫–∞—Ä–∞–≥–∞–Ω–¥–∞': '–ö–∞—Ä–∞–≥–∞–Ω–¥–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–≥.–∫–∞—Ä–∞–≥–∞–Ω–¥–∞': '–ö–∞—Ä–∞–≥–∞–Ω–¥–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–∫–∞—Ä–∞–≥–∞–Ω–¥–∞': '–ö–∞—Ä–∞–≥–∞–Ω–¥–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '“õ–∞—Ä–∞“ì–∞–Ω–¥—ã': '–ö–∞—Ä–∞–≥–∞–Ω–¥–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            'qaragandy': '–ö–∞—Ä–∞–≥–∞–Ω–¥–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',

            # –ö–æ—Å—Ç–∞–Ω–∞–π—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å
            '–∫–æ—Å—Ç–∞–Ω–∞–π—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å': '–ö–æ—Å—Ç–∞–Ω–∞–π—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–∫–æ—Å—Ç–∞–Ω–∞–π—Å–∫–∞—è –æ–±–ª': '–ö–æ—Å—Ç–∞–Ω–∞–π—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–∫–æ—Å—Ç–∞–Ω. –æ–±–ª': '–ö–æ—Å—Ç–∞–Ω–∞–π—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–∫–æ—Å—Ç–∞–Ω–∞–π—Å–∫–∞—è': '–ö–æ—Å—Ç–∞–Ω–∞–π—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–≥. –∫–æ—Å—Ç–∞–Ω–∞–π': '–ö–æ—Å—Ç–∞–Ω–∞–π—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–≥.–∫–æ—Å—Ç–∞–Ω–∞–π': '–ö–æ—Å—Ç–∞–Ω–∞–π—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–∫–æ—Å—Ç–∞–Ω–∞–π': '–ö–æ—Å—Ç–∞–Ω–∞–π—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',

            # –ö—ã–∑—ã–ª–æ—Ä–¥–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å
            '–∫—ã–∑—ã–ª–æ—Ä–¥–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å': '–ö—ã–∑—ã–ª–æ—Ä–¥–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–∫—ã–∑—ã–ª–æ—Ä–¥–∏–Ω—Å–∫–∞—è –æ–±–ª': '–ö—ã–∑—ã–ª–æ—Ä–¥–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–∫—ã–∑—ã–ª–æ—Ä–¥. –æ–±–ª': '–ö—ã–∑—ã–ª–æ—Ä–¥–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–∫—ã–∑—ã–ª–æ—Ä–¥–∏–Ω—Å–∫–∞—è': '–ö—ã–∑—ã–ª–æ—Ä–¥–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–≥. –∫—ã–∑—ã–ª–æ—Ä–¥–∞': '–ö—ã–∑—ã–ª–æ—Ä–¥–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–≥.–∫—ã–∑—ã–ª–æ—Ä–¥–∞': '–ö—ã–∑—ã–ª–æ—Ä–¥–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–∫—ã–∑—ã–ª–æ—Ä–¥–∞': '–ö—ã–∑—ã–ª–æ—Ä–¥–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',

            # –ú–∞–Ω–≥–∏—Å—Ç–∞—É—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å
            '–º–∞–Ω–≥–∏—Å—Ç–∞—É—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å': '–ú–∞–Ω–≥–∏—Å—Ç–∞—É—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–º–∞–Ω–≥–∏—Å—Ç–∞—É—Å–∫–∞—è –æ–±–ª': '–ú–∞–Ω–≥–∏—Å—Ç–∞—É—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–º–∞–Ω–≥–∏—Å—Ç. –æ–±–ª': '–ú–∞–Ω–≥–∏—Å—Ç–∞—É—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–º–∞–Ω–≥–∏—Å—Ç–∞—É—Å–∫–∞—è': '–ú–∞–Ω–≥–∏—Å—Ç–∞—É—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–≥. –∞–∫—Ç–∞—É': '–ú–∞–Ω–≥–∏—Å—Ç–∞—É—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–≥.–∞–∫—Ç–∞—É': '–ú–∞–Ω–≥–∏—Å—Ç–∞—É—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–∞–∫—Ç–∞—É': '–ú–∞–Ω–≥–∏—Å—Ç–∞—É—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',

            # –ü–∞–≤–ª–æ–¥–∞—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å
            '–ø–∞–≤–ª–æ–¥–∞—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å': '–ü–∞–≤–ª–æ–¥–∞—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–ø–∞–≤–ª–æ–¥–∞—Ä—Å–∫–∞—è –æ–±–ª': '–ü–∞–≤–ª–æ–¥–∞—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–ø–∞–≤–ª–æ–¥–∞—Ä. –æ–±–ª': '–ü–∞–≤–ª–æ–¥–∞—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–ø–∞–≤–ª–æ–¥–∞—Ä—Å–∫–∞—è': '–ü–∞–≤–ª–æ–¥–∞—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–≥. –ø–∞–≤–ª–æ–¥–∞—Ä': '–ü–∞–≤–ª–æ–¥–∞—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–≥.–ø–∞–≤–ª–æ–¥–∞—Ä': '–ü–∞–≤–ª–æ–¥–∞—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–ø–∞–≤–ª–æ–¥–∞—Ä': '–ü–∞–≤–ª–æ–¥–∞—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',

            # –°–µ–≤–µ—Ä–æ-–ö–∞–∑–∞—Ö—Å—Ç–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å
            '—Å–µ–≤–µ—Ä–æ-–∫–∞–∑–∞—Ö—Å—Ç–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å': '–°–µ–≤–µ—Ä–æ-–ö–∞–∑–∞—Ö—Å—Ç–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '—Å–µ–≤–µ—Ä–æ-–∫–∞–∑–∞—Ö—Å—Ç–∞–Ω—Å–∫–∞—è –æ–±–ª': '–°–µ–≤–µ—Ä–æ-–ö–∞–∑–∞—Ö—Å—Ç–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '—Å–µ–≤–µ—Ä–æ-–∫–∞–∑–∞—Ö—Å—Ç–∞–Ω—Å–∫–∞—è': '–°–µ–≤–µ—Ä–æ-–ö–∞–∑–∞—Ö—Å—Ç–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '—Å–µ–≤.-–∫–∞–∑–∞—Ö—Å—Ç–∞–Ω—Å–∫–∞—è': '–°–µ–≤–µ—Ä–æ-–ö–∞–∑–∞—Ö—Å—Ç–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '—Å–∫–æ': '–°–µ–≤–µ—Ä–æ-–ö–∞–∑–∞—Ö—Å—Ç–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–≥. –ø–µ—Ç—Ä–æ–ø–∞–≤–ª–æ–≤—Å–∫': '–°–µ–≤–µ—Ä–æ-–ö–∞–∑–∞—Ö—Å—Ç–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–≥.–ø–µ—Ç—Ä–æ–ø–∞–≤–ª–æ–≤—Å–∫': '–°–µ–≤–µ—Ä–æ-–ö–∞–∑–∞—Ö—Å—Ç–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–ø–µ—Ç—Ä–æ–ø–∞–≤–ª–æ–≤—Å–∫': '–°–µ–≤–µ—Ä–æ-–ö–∞–∑–∞—Ö—Å—Ç–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',

            # –ê–±–∞–π—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å
            '–∞–±–∞–π—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å': '–ê–±–∞–π—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–∞–±–∞–π—Å–∫–∞—è –æ–±–ª': '–ê–±–∞–π—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–∞–±–∞–π. –æ–±–ª': '–ê–±–∞–π—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–∞–±–∞–π—Å–∫–∞—è': '–ê–±–∞–π—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–≥. —Å–µ–º–µ–π': '–ê–±–∞–π—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–≥.—Å–µ–º–µ–π': '–ê–±–∞–π—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '—Å–µ–º–µ–π': '–ê–±–∞–π—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '—Å–µ–º–∏–ø–∞–ª–∞—Ç–∏–Ω—Å–∫': '–ê–±–∞–π—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',

            # –ñ–µ—Ç—ñ—Å—É—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å
            '–∂–µ—Ç—ñ—Å—É—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å': '–ñ–µ—Ç—ñ—Å—É—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–∂–µ—Ç—ñ—Å—É—Å–∫–∞—è –æ–±–ª': '–ñ–µ—Ç—ñ—Å—É—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–∂–µ—Ç—ñ—Å—É. –æ–±–ª': '–ñ–µ—Ç—ñ—Å—É—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–∂–µ—Ç—ñ—Å—É—Å–∫–∞—è': '–ñ–µ—Ç—ñ—Å—É—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–∂–µ—Ç–∏—Å—É': '–ñ–µ—Ç—ñ—Å—É—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–≥. —Ç–∞–ª–¥—ã–∫–æ—Ä–≥–∞–Ω': '–ñ–µ—Ç—ñ—Å—É—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–≥.—Ç–∞–ª–¥—ã–∫–æ—Ä–≥–∞–Ω': '–ñ–µ—Ç—ñ—Å—É—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '—Ç–∞–ª–¥—ã–∫–æ—Ä–≥–∞–Ω': '–ñ–µ—Ç—ñ—Å—É—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',

            # –£–ª—ã—Ç–∞—É—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å
            '—É–ª—ã—Ç–∞—É—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å': '–£–ª—ã—Ç–∞—É—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '—É–ª—ã—Ç–∞—É—Å–∫–∞—è –æ–±–ª': '–£–ª—ã—Ç–∞—É—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '—É–ª—ã—Ç–∞—É. –æ–±–ª': '–£–ª—ã—Ç–∞—É—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '—É–ª—ã—Ç–∞—É—Å–∫–∞—è': '–£–ª—ã—Ç–∞—É—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '—É–ª—ã—Ç–∞—É': '–£–ª—ã—Ç–∞—É—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–≥. –∂–µ–∑–∫–∞–∑–≥–∞–Ω': '–£–ª—ã—Ç–∞—É—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–≥.–∂–µ–∑–∫–∞–∑–≥–∞–Ω': '–£–ª—ã—Ç–∞—É—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å',
            '–∂–µ–∑–∫–∞–∑–≥–∞–Ω': '–£–ª—ã—Ç–∞—É—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å'
        }

        # –ò—â–µ–º —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è –æ—Ç —Å–∞–º—ã—Ö —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã—Ö –∫ –æ–±—â–∏–º
        for key, region in regions_map.items():
            if key in address_lower:
                return region

        return "–ù–µ —É–∫–∞–∑–∞–Ω"


# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä—Å–µ—Ä–∞
if __name__ == '__main__':
    parser = GoszakupParser()

    # –¢–µ—Å—Ç–æ–≤—ã–π –ø–æ–∏—Å–∫
    test_keywords = ["–º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ –∏–∑–¥–µ–ª–∏—è", "–∞—Ä–µ–Ω–¥–∞"]
    results = parser.search_lots(test_keywords, days_back=30)

    print(f"\nüìã –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:")
    print(f"–ù–∞–π–¥–µ–Ω–æ –ª–æ—Ç–æ–≤: {len(results)}")

    if results:
        print("\n–ü—Ä–∏–º–µ—Ä –ø–µ—Ä–≤–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞:")
        first = results[0]
        for key, value in first.items():
            print(f"  {key}: {value}")
