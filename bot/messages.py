"""
–®–∞–±–ª–æ–Ω—ã —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è Telegram –±–æ—Ç–∞
"""


def format_announcement_message(announcement: dict, for_manager: bool = True) -> str:
    """
    –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ–±—ä—è–≤–ª–µ–Ω–∏–∏

    Args:
        announcement: –î–∞–Ω–Ω—ã–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è
        for_manager: True –µ—Å–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è –º–µ–Ω–µ–¥–∂–µ—Ä–∞, False –¥–ª—è –∞–¥–º–∏–Ω–∞

    Returns:
        –û—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
    """
    if for_manager:
        message = (
            f"üîî <b>–ù–æ–≤–æ–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ</b>\n\n"
            f"üìã <b>–ù–æ–º–µ—Ä:</b> {announcement.get('announcement_number', 'N/A')}\n"
            f"üìç <b>–†–µ–≥–∏–æ–Ω:</b> {announcement.get('region', 'N/A')}\n"
            f"üè¢ <b>–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è:</b> {announcement.get('organization_name', 'N/A')}\n"
            f"üì´ <b>–Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–π –∞–¥—Ä–µ—Å:</b> {announcement.get('legal_address', 'N/A')}\n\n"
            f"üíº <b>–õ–æ—Ç:</b> {announcement.get('lot_name', 'N/A')}\n"
            f"üè∑Ô∏è <b>–ö–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ:</b> {announcement.get('keyword_matched', 'N/A')}\n\n"
            f"üîó <a href='{announcement.get('announcement_url', '#')}'>–û—Ç–∫—Ä—ã—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ</a>"
        )
    else:
        # –î–ª—è –∞–¥–º–∏–Ω–∞ –¥–æ–±–∞–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –º–µ–Ω–µ–¥–∂–µ—Ä–µ
        message = (
            f"üì¨ <b>–ù–æ–≤–æ–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–æ</b>\n\n"
            f"üë§ <b>–ú–µ–Ω–µ–¥–∂–µ—Ä:</b> {announcement.get('manager_name', 'N/A')}\n\n"
            f"üìã <b>–ù–æ–º–µ—Ä:</b> {announcement.get('announcement_number', 'N/A')}\n"
            f"üìç <b>–†–µ–≥–∏–æ–Ω:</b> {announcement.get('region', 'N/A')}\n"
            f"üè¢ <b>–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è:</b> {announcement.get('organization_name', 'N/A')}\n"
            f"üì´ <b>–Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–π –∞–¥—Ä–µ—Å:</b> {announcement.get('legal_address', 'N/A')}\n\n"
            f"üíº <b>–õ–æ—Ç:</b> {announcement.get('lot_name', 'N/A')}\n"
            f"üè∑Ô∏è <b>–ö–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ:</b> {announcement.get('keyword_matched', 'N/A')}\n\n"
            f"üîó <a href='{announcement.get('announcement_url', '#')}'>–û—Ç–∫—Ä—ã—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ</a>"
        )

    return message


def format_accepted_notification(announcement_number: str, manager_name: str) -> str:
    """–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω—É –æ –ø—Ä–∏–Ω—è—Ç–∏–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏—è"""
    return (
        f"‚úÖ <b>–û–±—ä—è–≤–ª–µ–Ω–∏–µ –ø—Ä–∏–Ω—è—Ç–æ</b>\n\n"
        f"üë§ <b>–ú–µ–Ω–µ–¥–∂–µ—Ä:</b> {manager_name}\n"
        f"üìã <b>–ù–æ–º–µ—Ä –æ–±—ä—è–≤–ª–µ–Ω–∏—è:</b> {announcement_number}"
    )


def format_rejected_notification(announcement_number: str, manager_name: str, reason: str) -> str:
    """–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω—É –æ–± –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏—è"""
    return (
        f"‚ùå <b>–û–±—ä—è–≤–ª–µ–Ω–∏–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–æ</b>\n\n"
        f"üë§ <b>–ú–µ–Ω–µ–¥–∂–µ—Ä:</b> {manager_name}\n"
        f"üìã <b>–ù–æ–º–µ—Ä –æ–±—ä—è–≤–ª–µ–Ω–∏—è:</b> {announcement_number}\n\n"
        f"üìù <b>–ü—Ä–∏—á–∏–Ω–∞:</b> {reason}"
    )


def format_stats_message(stats: dict) -> str:
    """–§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏"""
    return (
        f"üìä <b>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</b>\n\n"
        f"üì• –í—Å–µ–≥–æ –æ–±—ä—è–≤–ª–µ–Ω–∏–π: {stats.get('total', 0)}\n"
        f"‚è≥ –û–∂–∏–¥–∞—é—Ç –æ—Ç–≤–µ—Ç–∞: {stats.get('pending', 0)}\n"
        f"‚úÖ –ü—Ä–∏–Ω—è—Ç–æ: {stats.get('accepted', 0)}\n"
        f"‚ùå –û—Ç–∫–ª–æ–Ω–µ–Ω–æ: {stats.get('rejected', 0)}"
    )


def format_admin_dashboard(dashboard_data: dict) -> str:
    """
    –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≥–ª–∞–≤–Ω–æ–≥–æ –¥–∞—à–±–æ—Ä–¥–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

    Args:
        dashboard_data: –î–∞–Ω–Ω—ã–µ –¥–ª—è –¥–∞—à–±–æ—Ä–¥–∞ —Å–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π

    Returns:
        –û—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–∞—à–±–æ—Ä–¥–∞
    """
    from datetime import datetime

    # –¢–µ–∫—É—â–∞—è –¥–∞—Ç–∞ –∏ –≤—Ä–µ–º—è
    now = datetime.now()
    current_date = now.strftime("%d.%m.%Y")
    current_time = now.strftime("%H:%M")

    # –î–∞–Ω–Ω—ã–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–π
    new = dashboard_data.get('new', 0)
    in_progress = dashboard_data.get('in_progress', 0)
    processed = dashboard_data.get('processed', 0)
    rejected = dashboard_data.get('rejected', 0)
    total_today = dashboard_data.get('total_today', 0)

    # –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∑–æ–Ω—ã
    stuck_24h = dashboard_data.get('stuck_24h', 0)
    no_response_2h = dashboard_data.get('no_response_2h', 0)
    needs_attention = dashboard_data.get('needs_attention', 0)

    message = (
        f"‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n"
        f"üëî <b>–ê–î–ú–ò–ù-–ü–ê–ù–ï–õ–¨</b>\n"
        f"‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n\n"
        f"üìÖ –°–µ–≥–æ–¥–Ω—è: {current_date}\n"
        f"‚è∞ –û–±–Ω–æ–≤–ª–µ–Ω–æ: {current_time}\n\n"

        f"üìä <b>–û–ë–™–Ø–í–õ–ï–ù–ò–Ø</b>\n\n"
        f"üÜï –ù–æ–≤—ã–µ: <b>{new}</b>\n"
        f"‚è≥ –í —Ä–∞–±–æ—Ç–µ: <b>{in_progress}</b>\n"
        f"‚úÖ –û–±—Ä–∞–±–æ—Ç–∞–Ω—ã: <b>{processed}</b>\n"
        f"‚ùå –û—Ç–∫–ª–æ–Ω–µ–Ω—ã: <b>{rejected}</b>\n\n"
        f"üìà –í—Å–µ–≥–æ –∑–∞ –¥–µ–Ω—å: <b>{total_today}</b>\n\n"

        f"‚ö° <b>–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ó–û–ù–´</b>\n\n"
        f"üî¥ –ó–∞–≤–∏—Å–ª–∏ &gt;24—á: <b>{stuck_24h}</b>\n"
        f"üü° –ë–µ–∑ –æ—Ç–≤–µ—Ç–∞ &gt;2—á: <b>{no_response_2h}</b>\n"
        f"‚ö†Ô∏è –ù—É–∂–Ω–æ –≤–Ω–∏–º–∞–Ω–∏–µ: <b>{needs_attention}</b>"
    )

    return message


START_MESSAGE = """
üëã –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ —Å–∏—Å—Ç–µ–º—É –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –≥–æ—Å–∑–∞–∫—É–ø–æ–∫!

–≠—Ç–æ—Ç –±–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –Ω–æ–≤—ã—Ö –æ–±—ä—è–≤–ª–µ–Ω–∏—è—Ö –Ω–∞ –ø–æ—Ä—Ç–∞–ª–µ goszakup.gov.kz.

<b>–í–∞—à–∏ –¥–µ–π—Å—Ç–≤–∏—è:</b>
‚Ä¢ –ü—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏—è –Ω–∞–∂–º–∏—Ç–µ <b>"–ü—Ä–∏–Ω—è—Ç—å"</b> –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –Ω–∏–º
‚Ä¢ –ù–∞–∂–º–∏—Ç–µ <b>"–û—Ç–∫–ª–æ–Ω–∏—Ç—å"</b> –∏ —É–∫–∞–∂–∏—Ç–µ –ø—Ä–∏—á–∏–Ω—É –æ—Ç–∫–∞–∑–∞

<b>–ö–æ–º–∞–Ω–¥—ã:</b>
/start - –ù–∞—á–∞–ª–æ —Ä–∞–±–æ—Ç—ã
/help - –°–ø—Ä–∞–≤–∫–∞
/stats - –ú–æ—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

–£–¥–∞—á–∏ –≤ —Ä–∞–±–æ—Ç–µ!
"""

HELP_MESSAGE = """
‚ÑπÔ∏è <b>–°–ø—Ä–∞–≤–∫–∞ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –±–æ—Ç–∞</b>

<b>–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–∏—Å—Ç–µ–º–∞:</b>
1. –ë–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–∞—Ä—Å–∏—Ç –ø–æ—Ä—Ç–∞–ª goszakup.gov.kz
2. –ù–∞—Ö–æ–¥–∏—Ç –æ–±—ä—è–≤–ª–µ–Ω–∏—è –ø–æ –≤–∞—à–∏–º –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º –∏ —Ä–µ–≥–∏–æ–Ω—É
3. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤–∞–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø–æ–¥—Ö–æ–¥—è—â–∏—Ö –æ–±—ä—è–≤–ª–µ–Ω–∏—è—Ö

<b>–ß—Ç–æ –¥–µ–ª–∞—Ç—å –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:</b>
‚Ä¢ –û–∑–Ω–∞–∫–æ–º—å—Ç–µ—Å—å —Å –¥–µ—Ç–∞–ª—è–º–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏—è
‚Ä¢ –ü–µ—Ä–µ–π–¥–∏—Ç–µ –ø–æ —Å—Å—ã–ª–∫–µ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –Ω–∞ –ø–æ—Ä—Ç–∞–ª–µ
‚Ä¢ –ù–∞–∂–º–∏—Ç–µ "–ü—Ä–∏–Ω—è—Ç—å" –µ—Å–ª–∏ –≥–æ—Ç–æ–≤—ã —Ä–∞–±–æ—Ç–∞—Ç—å —Å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ–º
‚Ä¢ –ù–∞–∂–º–∏—Ç–µ "–û—Ç–∫–ª–æ–Ω–∏—Ç—å" –∏ —É–∫–∞–∂–∏—Ç–µ –ø—Ä–∏—á–∏–Ω—É, –µ—Å–ª–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ –Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç

<b>–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:</b>
/start - –ù–∞—á–∞–ª–æ —Ä–∞–±–æ—Ç—ã
/help - –≠—Ç–∞ —Å–ø—Ä–∞–≤–∫–∞
/stats - –í–∞—à–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–º –æ–±—ä—è–≤–ª–µ–Ω–∏—è–º

–ü–æ –≤–æ–ø—Ä–æ—Å–∞–º –æ–±—Ä–∞—â–∞–π—Ç–µ—Å—å –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É.
"""
